# Fiber Pulse Simulation

–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–º–æ–¥–æ–≤–æ–≥–æ –≤–æ–ª–æ–∫–Ω–∞ + –ë—Ä—ç–≥–≥–æ–≤—Å–∫–∏–π —Å—Ç—Ä–µ—Ç—á–µ—Ä + —Ä–µ—à—ë—Ç–æ—á–Ω—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä + –∫–∞—Å–∫–∞–¥—ã —É—Å–∏–ª–µ–Ω–∏—è —Å –Ω–∞—Å—ã—â–µ–Ω–∏–µ–º.  
CPU/GPU backends (pyFFTW/cuFFT), –∂–∏–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ 2√ó2, –∞–≤—Ç–æ—Å–µ–π–≤—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ (DE ‚Üí L-BFGS-B).

---

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ù–µ–ª–∏–Ω–µ–π–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è –∏–º–ø—É–ª—å—Å–∞ –≤ –≤–æ–ª–æ–∫–Ω–µ**: –¥–∏—Å–ø–µ—Ä—Å–∏—è –¥–æ Œ≤‚ÇÇ‚Ä¶Œ≤‚ÇÖ (–∏–∑ Sellmeier), –∫–µ—Ä—Ä–æ–≤—Å–∫–∞—è –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å, —Å—Ö–µ–º–∞ —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (–ª–∏–Ω–µ–π–Ω–∞—è —á–∞—Å—Ç—å –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏, –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è ‚Äî –≤ –≤—Ä–µ–º–µ–Ω–∏) —Å **RK4** –¥–ª—è SPM.
- **–°—Ç—Ä–µ—Ç—á–µ—Ä (BFG)**: –∑–µ—Ä–∫–∞–ª—å–Ω–∞—è –ë—Ä—ç–≥–≥–æ–≤—Å–∫–∞—è —Ä–µ—à—ë—Ç–∫–∞ ‚Äî —Å—É–ø–µ—Ä–≥–∞—É—Å—Å–æ–≤–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ + –º–Ω–æ–≥–æ—á–ª–µ–Ω —Ñ–∞–∑—ã –¥–æ 5-–≥–æ –ø–æ—Ä—è–¥–∫–∞.
- **–ì—Ä—ç—Ç–∏–Ω–≥–æ–≤—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä**: –ø–æ–ª–∏–Ω–æ–º œÜ(œâ) –¥–æ 5-–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∏–∑ –ø–∞—Ä–∞ –≥—Ä—ç—Ç–∏–Ω–≥–æ–≤; **–ø–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö** (Œ≥, L) —á–µ—Ä–µ–∑ `differential_evolution` (+ –ª–æ–∫–∞–ª—å–Ω—ã–π `L-BFGS-B`).
- **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ Yb¬≥‚Å∫** —Å **–Ω–∞—Å—ã—â–∞—é—â–∏–º—Å—è** –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º, —Å –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º —É—Å–∏–ª–µ–Ω–∏—è.
- **–ì—Ä–∞—Ñ–∏–∫–∏ ‚Äú–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏‚Äù (blitting)**: $I(t)$, $PSD(Œª)$ (—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –º–æ—â–Ω–æ—Å—Ç–∏), 
—Å–¥–≤–∏–≥ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã, –≥—Ä—É–ø–ø–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞; –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ PNG.
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** (`.npz`) –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞; –∞–≤—Ç–æ–ø–∞—É–∑–∞/—Ä–µ–∑—é–º–∏—Ä–æ–≤–∞–Ω–∏–µ.
- **CPU/GPU**: 
  - CPU: `pyFFTW` —Å –ø–ª–∞–Ω–∞–º–∏ –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å—é,
  - GPU: `CuPy`/`cuFFT` + –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ FFT.

---

## üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–æ—á–µ–Ω—å –∫—Ä–∞—Ç–∫–æ)

### –ú–æ–¥–µ–ª—å: –æ–±–æ–±—â—ë–Ω–Ω–æ–µ –ù–£–® (–Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –®—Ä—ë–¥–∏–Ω–≥–µ—Ä–∞, NLSE) —Å –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π –¥–æ 5-–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∏ –∫–µ—Ä—Ä–æ–≤—Å–∫–æ–π –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å—é

–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–∞–∑–µ—Ä–Ω—ã—Ö –∏–º–ø—É–ª—å—Å–æ–≤ –≤ –≤–æ–ª–æ–∫–Ω–µ –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —ç–≤–æ–ª—é—Ü–∏–∏:

![1](images/1.png)

–≥–¥–µ  
$\displaystyle \beta_n = \frac{d^n k(\omega)}{d\omega^n}$ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏—Å–ø–µ—Ä—Å–∏–∏ $n$-–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞,  
$\displaystyle \sum_{n=2}^{5} \frac{\beta_n}{n!}$ ‚Äî —É—á—ë—Ç –≤–∫–ª–∞–¥–∞ 2‚Äì5 –ø–æ—Ä—è–¥–∫–æ–≤ –¥–∏—Å–ø–µ—Ä—Å–∏–∏,  
–∞ $\hat{\gamma}|E|^2E$ ‚Äî —Ñ–∞–∑–æ–≤–∞—è —Å–∞–º–æ–º–æ–¥—É–ª—è—Ü–∏—è:

![2](images/2.png)

–≥–¥–µ $\gamma(\omega)$ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏. –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º, —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏—é –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏. 
–ë–µ–∑ –µ—ë —É—á—ë—Ç–∞ $\gamma(\omega)$ —Ç–µ—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π.  

$\hat{g}(\omega)E(z,t)$ ‚Äî —É—Å–∏–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –∏—Ç—Ç–µ—Ä–±–∏–µ–≤–æ–≥–æ –≤–æ–ª–æ–∫–Ω–∞:

![3](images/3.png)

–≥–¥–µ $g(\omega)$ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ

<p align="center">
  <img src="images/–°–ø–µ–∫—Ç—Ä%20—É—Å–∏–ª–µ–Ω–∏—è.png" alt="–°–ø–µ–∫—Ç—Ä —É—Å–∏–ª–µ–Ω–∏—è" 
       width="500" style="filter: invert(1) contrast(0.73) brightness(.945);">
  <br>
  <em>–ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–µ–∫—Ç—Ä —É—Å–∏–ª–µ–Ω–∏—è –∏—Ç—Ç–µ—Ä–±–∏—è</em>
</p>

–í —É—Ä–∞–≤–Ω–µ–Ω–∏–∏ (1) –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∞ —Ç–æ—á–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –§—É—Ä—å–µ-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. 
–î–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –º–µ—Ç–æ–¥ –†—É–Ω–≥–µ‚Äì–ö—É—Ç—Ç–∞ 4‚Äì5 –ø–æ—Ä—è–¥–∫–∞. 
–≠—Ç–∏ –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é split-step –º–µ—Ç–æ–¥–∞. 
–¢–∞–∫ –∫–∞–∫ –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–∞—è —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ—á–Ω–æ, —à–∞–≥ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ñ–∞–∑–æ–≤–æ–π —Å–∞–º–æ–º–æ–¥—É–ª—è—Ü–∏–∏.

### –†–µ—à—ë—Ç–æ—á–Ω—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä

–§–∞–∑–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ $\phi_c(\omega; \gamma, L)$ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞ –≤ —Ä—è–¥ –¥–æ 5-–≥–æ –ø–æ—Ä—è–¥–∫–∞,
$$
\phi_c(\omega) \approx \frac{\beta_2(\gamma,L)}{2}\omega^2 + \frac{\beta_3(\gamma,L)}{6}\omega^3 + \frac{\beta_4}{24}\omega^4 + \frac{\beta_5}{120}\omega^5,
$$
–≥–¥–µ $\beta_m$ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≤–µ–¥–µ–Ω—ã –∏–∑ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –ø–∞—Ä—ã —Ä–µ—à—ë—Ç–æ–∫ (—É–≥–æ–ª $\gamma$, –±–∞–∑–æ–≤–∞—è –¥–ª–∏–Ω–∞ $L$, –ø–µ—Ä–∏–æ–¥ $d$).

**–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** ‚Äî –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–π —Ñ–∞–∑—ã –≤ –ø–æ–ª–æ—Å–µ —Å–ø–µ–∫—Ç—Ä–∞:
$$
J(\gamma,L)=\sum_{\omega \in \Omega}\Big(\phi_{\text{pulse}}(\omega)-\phi_c(\omega;\gamma,L)\Big)^2,
$$

–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ **Differential Evolution** (–ª–∞—Ç–∏–Ω—Å–∫–∏–π –≥–∏–ø–µ—Ä–∫—É–±, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è `currenttobest1bin`), –∑–∞—Ç–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π **L-BFGS-B** –Ω–∞ —Å—É–∑–∏–≤—à–∏—Ö—Å—è –≥—Ä–∞–Ω–∏—Ü–∞—Ö.

